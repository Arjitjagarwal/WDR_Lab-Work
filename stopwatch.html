<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Stopwatch</title>

<style>
    /* Styling body layout */
    body {
        font-family: Arial, sans-serif;
        background-color: #111;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }

    /* Main stopwatch box */
    .container {
        text-align: center;
        background: #1e1e1e;
        padding: 25px;
        border-radius: 12px;
        width: 350px;
    }

    /* Time display styling */
    #display {
        font-size: 40px;
        margin: 20px 0;
    }

    /* Buttons styling */
    button {
        padding: 10px 20px;
        margin: 5px;
        background: #444;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 6px;
    }

    /* Disabled button effect */
    button:disabled {
        background: #777;
        cursor: not-allowed;
    }

    /* Lap list scrollable */
    #laps {
        margin-top: 20px;
        max-height: 150px;
        overflow-y: auto;
        font-size: 16px;
    }
</style>
</head>
<body>

<div class="container">
    <h2>‚è± Stopwatch</h2>

    <!-- Time Display -->
    <div id="display">00:00.000</div>

    <!-- Buttons for user actions -->
    <button id="startStopBtn">Start</button>
    <button id="lapBtn" disabled>Lap</button>
    <button id="resetBtn">Reset</button>

    <!-- Lap times section -->
    <div id="laps">No Laps Yet</div>
</div>

<script>

// ---------- VARIABLE DECLARATIONS ----------

// Stores whether stopwatch is running or not
let running = false;

// Stores when time started (in ms)
let startTime = 0;

// Stores previously elapsed time (used when paused)
let elapsedTime = 0;

// Stores setInterval reference so we can stop it later
let interval;

// Stores recorded lap times
let lapTimes = [];

// Linking HTML elements with JavaScript
const display = document.getElementById("display");
const startStopBtn = document.getElementById("startStopBtn");
const lapBtn = document.getElementById("lapBtn");
const resetBtn = document.getElementById("resetBtn");
const lapsDiv = document.getElementById("laps");



// ---------- FUNCTION TO FORMAT TIME ----------

/*
    This function converts milliseconds into:
    MM:SS.mmm (minutes, seconds, milliseconds)
*/
function formatTime(ms) {
    const minutes = String(Math.floor(ms / 60000)).padStart(2, "0");
    const seconds = String(Math.floor((ms % 60000) / 1000)).padStart(2, "0");
    const milliseconds = String(ms % 1000).padStart(3, "0");

    return `${minutes}:${seconds}.${milliseconds}`;
}



// ---------- FUNCTION TO UPDATE STOPWATCH DISPLAY ----------

/*
    Called repeatedly (every 10ms).
    It updates the time based on current and stored values.
*/
function updateDisplay() {
    const now = Date.now(); // current time in ms
    const currentElapsed = elapsedTime + (now - startTime);
    display.textContent = formatTime(currentElapsed);
}



// ---------- START / STOP FUNCTION ----------

/*
    This function starts or stops the stopwatch.
    It toggles between running and paused states.
*/
function startStop() {

    if (!running) {

        // Start stopwatch
        running = true;
        startTime = Date.now() - elapsedTime;
        
        // Update display repeatedly every 10ms
        interval = setInterval(updateDisplay, 10);

        startStopBtn.textContent = "Stop";
        lapBtn.disabled = false;

    } else {

        // Pause stopwatch
        running = false;
        clearInterval(interval);
        elapsedTime += Date.now() - startTime; // store elapsed time

        startStopBtn.textContent = "Start";
        lapBtn.disabled = true;
    }
}



// ---------- RESET FUNCTION ----------

/*
    This function clears everything:
    - Time resets to 00:00.000
    - Lap history clears
    - Stopwatch stops
*/
function resetStopwatch() {
    running = false;
    clearInterval(interval);

    elapsedTime = 0;
    display.textContent = "00:00.000";
    lapTimes = [];
    lapsDiv.innerHTML = "No Laps Yet";

    startStopBtn.textContent = "Start";
    lapBtn.disabled = true;
}



// ---------- LAP FUNCTION ----------

/*
    Records current running time as a lap
*/
function recordLap() {

    if (!running) return;

    const now = Date.now();
    const time = formatTime(elapsedTime + (now - startTime));

    lapTimes.push(time);

    // Display lap list
    lapsDiv.innerHTML = lapTimes
        .map((lap, index) => `Lap ${index + 1}: ${lap}`)
        .join("<br>");
}



// ---------- EVENT LISTENERS ----------

// Button actions
startStopBtn.addEventListener("click", startStop);
resetBtn.addEventListener("click", resetStopwatch);
lapBtn.addEventListener("click", recordLap);


// ---------- OPTIONAL KEYBOARD SHORTCUTS ----------

/*
    Space = Start/Stop
    L = Lap
    R = Reset
*/
document.addEventListener("keydown", (event) => {
    if (event.code === "Space") startStop();
    if (event.key === "l" || event.key === "L") recordLap();
    if (event.key === "r" || event.key === "R") resetStopwatch();
});

</script>
</body>
</html>
